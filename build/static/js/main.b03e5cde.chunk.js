(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{115:function(e,t,n){},116:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),u=n(9),l=n.n(u),o=n(14),i=n(162),s=n(26),m=n(13),f=n(39),p=n(21),d=n(7),v=n.n(d),E=n(15),b=n(77),g=n(23),h=n.n(g),O="/api/blogs",y=null,j=function(){var e=Object(E.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get(O);case 2:return t=e.sent,e.abrupt("return",t.data.sort((function(e,t){return t.likes-e.likes})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(E.a)(v.a.mark((function e(t){var n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:y}},e.next=3,h.a.post(O,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(E.a)(v.a.mark((function e(t){var n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:y}},e.next=3,h.a.put("".concat(O,"/").concat(t.id),t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(E.a)(v.a.mark((function e(t){var n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:y}},e.next=3,h.a.put("".concat(O,"/").concat(t.id),t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N={getAll:j,setToken:function(e){y="bearer ".concat(e)},create:w,increaseLikes:k,deletePost:function(){var e=Object(E.a)(v.a.mark((function e(t){var n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:y}},e.next=3,h.a.delete("".concat(O,"/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addComment:x},I=function(e,t,n){return function(r){r({type:"SET_NOTIFICATION",data:{content:e,style:t}}),a&&clearTimeout(a),a=setTimeout((function(){r({type:"REMOVE_NOTIFICATION",data:null})}),1e3*n)}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.data;case"REMOVE_NOTIFICATION":return null;default:return e}},T={getAll:function(){var e=Object(E.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get("/api/users");case 2:return t=e.sent,console.log(t.data),e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),setToken:function(e){"bearer ".concat(e)}},L=function(){return function(){var e=Object(E.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getAll();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;default:return e}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_BLOG":var n=t.data.id;return e.map((function(e){return e.id!==n?e:t.data}));case"NEW_BLOG":return[].concat(Object(b.a)(e),[t.data]);case"INIT_BLOGS":return t.data;case"REMOVE_BLOG":return e.filter((function(e){return e.id!==t.data}));default:return e}},A=n(146),G=c.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),a=Object(p.a)(n,2),u=a[0],l=a[1],o={display:u?"none":""},i={display:u?"":"none"},s=function(){l(!u)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:s}})),c.a.createElement("div",null,c.a.createElement("div",{style:o},c.a.createElement(A.a,{variant:"contained",onClick:s},e.buttonLabel)),c.a.createElement("div",{style:i,className:"togglableContent"},e.children,c.a.createElement(A.a,{variant:"contained",onClick:s},"Cancel")))}));G.displayName="Togglable";var _=G,U=function(){var e=Object(o.b)(),t=Object(r.useState)(""),n=Object(p.a)(t,2),a=n[0],u=n[1],l=Object(r.useState)(""),i=Object(p.a)(l,2),s=i[0],m=i[1],d=Object(r.useState)(""),b=Object(p.a)(d,2),g=b[0],h=b[1];return c.a.createElement(_,{buttonLabel:"New blog"},c.a.createElement("div",{className:"formDiv"},c.a.createElement("form",{onSubmit:function(t){var n;t.preventDefault(),e((n={title:a,author:s,url:g},function(){var e=Object(E.a)(v.a.mark((function e(t){var a,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.create(n);case 2:a=e.sent,r="New blog ".concat(n.title," by ").concat(n.author," added"),t(I(r,"success",5)),t({type:"NEW_BLOG",data:Object(f.a)(Object(f.a)({},a),{},{user:"NewlyCreatedBlog"})}),t(L());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),h(""),u(""),m("")}},"Title: ",c.a.createElement("input",{id:"title",value:a,onChange:function(e){return u(e.target.value)}}),c.a.createElement("br",null),"Author: ",c.a.createElement("input",{id:"author",value:s,onChange:function(e){return m(e.target.value)}}),c.a.createElement("br",null),"Url: ",c.a.createElement("input",{id:"url",value:g,onChange:function(e){return h(e.target.value)}}),c.a.createElement("br",null),c.a.createElement("button",{type:"submit"},"Save"))))},R=n(151),D=n(117),P=n(152),z=n(153),M=n(154),F=n(155),V=n(156),W=n(157),J=n(158),H=n(159),q=n(163),K=n(150),Q=n(73),X=n.n(Q),Y=Object(K.a)({inputField:{marginLeft:"10px"},inputButton:{marginLeft:"10px",position:"relative",top:"17px"}}),Z=function(e){var t=e.title,n=e.author,a=e.id;return c.a.createElement("div",null,c.a.createElement(s.b,{to:"/blogs/".concat(a)},t," by ",n))},$=function(e){var t=e.blogs;return c.a.createElement("div",null,c.a.createElement("h2",null,"Create new blog"),c.a.createElement(U,null),c.a.createElement("br",null),c.a.createElement(R.a,{component:D.a},c.a.createElement(P.a,null,c.a.createElement(z.a,null,t.map((function(e){return c.a.createElement(M.a,{key:e.id},c.a.createElement(F.a,null,c.a.createElement(Z,{title:e.title,author:e.author,id:e.id})))}))))))},ee=function(e){var t=e.blogs,n=e.user,a=Object(o.b)(),u=Object(m.f)(),l=Object(m.g)().id,i=t.find((function(e){return e.id.toString()===l.toString()})),s=Object(r.useState)(""),d=Object(p.a)(s,2),b=d[0],g=d[1],h=Y();if(!i)return null;var O=function(e){var t,n=e;n.likes=+n.likes+1,n.user=n.user.id?n.user.id:n.user,a((t=n,function(){var e=Object(E.a)(v.a.mark((function e(n){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.increaseLikes(t);case 2:a=e.sent,n({type:"UPDATE_BLOG",data:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))},y=function(e){a(function(e){return function(){var t=Object(E.a)(v.a.mark((function t(n){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.deletePost(e);case 3:t.sent,t.next=10;break;case 6:return t.prev=6,t.t0=t.catch(0),console.log(t.t0),t.abrupt("return");case 10:n({type:"REMOVE_BLOG",data:e});case 11:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()}(e)),u.push("/")},j=function(e,t,n){e.preventDefault();var r=Object(f.a)(Object(f.a)({},t),{},{comments:t.comments.concat(n),user:t.user&&t.user.id?t.user.id:t.user});a(function(e){return function(){var t=Object(E.a)(v.a.mark((function t(n){var a;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.addComment(e);case 2:a=t.sent,n({type:"UPDATE_BLOG",data:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(r)),g("")};return c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement("h2",null,i.title),c.a.createElement(V.a,{component:"nav"},c.a.createElement(W.a,null,c.a.createElement(J.a,{primary:"Url: ".concat(i.url)})),c.a.createElement(W.a,null,c.a.createElement(J.a,{primary:"Likes: ".concat(i.likes)}),c.a.createElement(H.a,null,c.a.createElement(X.a,{onClick:function(){return O(i)}}))),c.a.createElement(W.a,null,c.a.createElement(J.a,{primary:"Author: ".concat(i.author)})),n&&n.username===i.user.username?c.a.createElement(W.a,null,c.a.createElement(H.a,null,c.a.createElement(A.a,{size:"small",variant:"contained",color:"primary",type:"submit",onClick:function(){return y(i.id)},"data-id":i.id},"Remove"))):c.a.createElement("div",null)),c.a.createElement("h3",null,"Comments"),c.a.createElement("ul",null,i.comments.map((function(e,t){return c.a.createElement("li",{key:t},e)}))),c.a.createElement("form",{onSubmit:function(e){return j(e,i,b)}},c.a.createElement(q.a,{label:"comment",value:b,className:h.inputField,onChange:function(e){var t=e.target;return g(t.value)}}),c.a.createElement(A.a,{size:"small",variant:"contained",color:"primary",type:"submit",className:h.inputButton},"Post"))))},te=n(164),ne=function(){var e=Object(o.c)((function(e){return e.notification}));return null===e?null:c.a.createElement(te.a,{severity:e.style},e.content)},ae=function(e){var t=e.users,n=Object(m.g)().id,a=t.find((function(e){return e.id.toString()===n.toString()}));return a?c.a.createElement("div",null,c.a.createElement("h2",null,a.username),c.a.createElement("br",null),c.a.createElement("h4",null,"Added Blogs"),c.a.createElement("ul",null,a.blogs.map((function(e,t){return c.a.createElement("li",{key:t},e.title)})))):null},re=function(){var e=Object(o.c)((function(e){return e.users}));return console.log(e),c.a.createElement("div",{className:"userGridParent"},c.a.createElement("span",{className:"userGridItem"},c.a.createElement("h3",null,"Users"),c.a.createElement("br",null),c.a.createElement("b",null,"Blogs created:")),c.a.createElement(R.a,{component:D.a},c.a.createElement(P.a,null,c.a.createElement(z.a,null,e.map((function(e,t){return c.a.createElement(M.a,{key:t},c.a.createElement(F.a,null,e.username),c.a.createElement(F.a,null,e.blogs.length))}))))))},ce={login:function(){var e=Object(E.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},ue=function(){return function(){var e=Object(E.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.setItem("loggedBlogappUser",null),t({type:"LOGOUT",data:null});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.data;case"LOGOUT":return null;default:return e}},oe=function(){var e=Object(o.b)(),t=Object(r.useState)(""),n=Object(p.a)(t,2),a=n[0],u=n[1],l=Object(r.useState)(""),i=Object(p.a)(l,2),s=i[0],m=i[1];return c.a.createElement(_,{buttonLabel:"login"},c.a.createElement("div",null,c.a.createElement("h2",null,"Login"),c.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e(function(e,t){return function(){var n=Object(E.a)(v.a.mark((function n(a){var r,c;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,ce.login({username:e,password:t});case 3:r=n.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(r)),N.setToken(r.token),c="".concat(e," successfully logged in"),a(I(c,"success",5)),a({type:"LOGIN",data:r}),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(0),"Wrong credentials",a(I("Wrong credentials","error",5));case 15:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}()}(a,s)),u(""),m("")}},c.a.createElement("div",null,c.a.createElement(q.a,{label:"username",value:a,onChange:function(e){var t=e.target;return u(t.value)}})),c.a.createElement("div",null,c.a.createElement(q.a,{label:"password",value:s,onChange:function(e){var t=e.target;return m(t.value)},type:"password"})),c.a.createElement(A.a,{variant:"contained",color:"primary",type:"submit"},"Login"))))},ie=n(160),se=n(161),me=n(49),fe=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.user}));return c.a.createElement("div",null,c.a.createElement(ie.a,{position:"static"},c.a.createElement(se.a,{variant:"dense"},c.a.createElement(me.a,{variant:"h6",color:"inherit",className:"menuBar",id:"HomeButton"},c.a.createElement(s.b,{to:"/"},"Home")),c.a.createElement(me.a,{variant:"h6",color:"inherit",className:"menuBar"},c.a.createElement(s.b,{to:"/users"},"Users")),c.a.createElement("div",{className:"rightMenu menuBar"},"".concat(t.username," logged in")),c.a.createElement(A.a,{className:"rightMenu menuBar",variant:"contained",size:"small",onClick:function(){e(ue())}},"Log you out"))),c.a.createElement("h2",null,"Blogs"),c.a.createElement("br",null))},pe=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.notification})),n=Object(o.c)((function(e){return e.blogs})),a=Object(o.c)((function(e){return e.user})),u=Object(o.c)((function(e){return e.users}));return Object(r.useEffect)((function(){var t=window.localStorage.getItem("loggedBlogappUser");if(t){var n=JSON.parse(t);if(null===a)return;e(function(e){return function(t){null!==e?(N.setToken(e.token),t({type:"LOGIN",data:e})):ue()}}(n))}}),[e]),Object(r.useEffect)((function(){e(function(){var e=Object(E.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.getAll();case 2:n=e.sent,console.log(n),t({type:"INIT_BLOGS",data:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(L())}),[e]),c.a.createElement(i.a,null,c.a.createElement(s.a,null,c.a.createElement("div",null,null===a?c.a.createElement("div",null,c.a.createElement("h2",null,"Please log in"),c.a.createElement(ne,{message:t}),c.a.createElement(oe,null)):c.a.createElement("div",null,c.a.createElement(fe,null),c.a.createElement(ne,{message:t}),c.a.createElement(m.c,null,c.a.createElement(m.a,{path:"/users/:id"},c.a.createElement(ae,{users:u})),c.a.createElement(m.a,{path:"/blogs/:id"},c.a.createElement(ee,{blogs:n,user:a})),c.a.createElement(m.a,{path:"/users"},c.a.createElement(re,null)),c.a.createElement(m.a,{path:"/"},c.a.createElement($,{blogs:n})))))))},de=n(32),ve=n(75),Ee=n(76),be=Object(de.combineReducers)({notification:S,blogs:C,user:le,users:B}),ge=Object(de.createStore)(be,Object(Ee.composeWithDevTools)(Object(de.applyMiddleware)(ve.a)));n(115);l.a.render(c.a.createElement(o.a,{store:ge},c.a.createElement(pe,null)),document.getElementById("root"))},85:function(e,t,n){e.exports=n(116)}},[[85,1,2]]]);
//# sourceMappingURL=main.b03e5cde.chunk.js.map